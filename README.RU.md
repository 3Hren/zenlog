# Logging Zen

Log transport, filtering and processing.

# Особенности
- Easily configurable.
- Performance and safety.

# Getting Started
## Pipeline

В процессе настройки программы пользователь описывает цепочки обработчиков в виде ациклического однонаправленного графа.

В конфигурационном файле проще всего это описать используя YAML, который имеет лаконичный формат и позволяет заводить алиасы.

Например, граф такого вида будет принимать сообщения по TCP на порту 50030, пытаться распаковать их как JSON и отправлять данные по файлам, закодировав их по указанному паттерну:

```yml
severity: 0
pipeline:
  - input:
      - type: tcp       
        port: 50030
        protocol: json
      - type: random
        rate: 1.0
        range: [8, 8]
    filter:
        - type: hostname
        - type: route
          /fields: [timestamp, message]
    output:
      - type: null
      - type: files
        path: /var/log/{source}/{severity}.log
        protocol:
          pattern: "{severity}, [{timestamp}]: {message}"
```

Где **pipeline** - имя графа.

## Сигналы
Zenlog умеет специально обрабатывать три типа сигналов - SIGINT, SIGTERM и SIGHUP. Остальные сигналы обрабатываются стандартными обработчиками (см. POSIX API).

При получении SIGINT и SIGTERM программа иницирует процесс завершения.

При получении SIGHUP программа перечитывает конфигурационный файл и при наличии изменений перезагружает обработчики в таком порядке, при котором гарантируется отсутствие потери логов.

# API
## Input
Input модули представляют собой источники данных. С большинством из них все время должен быть ассоциирован какой-либо протокол. Однако существуют и такие источники, для которых существуют протоколы *по-умолчанию*.

Пример: UDP Input, который в этом случае будет считать датаграмму целиком по **delimiter** протоколу, где разделителем будет считаться EOF (end of file).

### Standard Input
### UDP
Модуль запускает слушающий UDP сокет на указанный порт.

### TCP

## Протоколы
Zenlog оперирует внутренней json-like структурой данных, которая изначально преобразуется из входной последовательности байт в Input модуле. В конечом счете эту структуру необходимо преобразовать в выходной массив байт для записи в Output модуле. Это поведение описывается **протоколом**.

### JSON
### Delimiter

## Фильтры

## Output

### Files
### Elasticsearch

# Настройка
# Advanced
